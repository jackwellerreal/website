<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jack Weller</title>
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="../styles.css">
    <link rel="icon" href="../../assets/pfp.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

    <!--! Font Awesome Pro 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
</head>

<body>
    <div class="container">
        <header>
            <a href="/">
                <h1>Jack Weller</h1>
            </a>
            <nav>
                <a href="/projects/">Projects</a>
                <a href="/blog/">Blog</a>
                <a href="/contact/">Contact</a>
            </nav>
        </header>
        <main>
            <div class="title">
                <img src="assets/title.jpg" />
                <h1>Free Chicken Exploit</h1>
                <p>How I hacked Red Rooster to get unlimited free food.</p>
            </div>
            <hr>
            <div class="content">
                <p>
                    Red Rooster is the sixth biggest restaurant in Australia, who are known for their fried chicken and
                    chips. They have around 350 stores spread accorss the country, and are a popular choice for many
                    Australians when they want a quick meal.
                </p>

                <p>
                    One friday night, I was feeling hungry and decided to order Red Rooster for dinner using their
                    mobile app. The mobile app allows customers to order and pay for food on the menu quickly and
                    easily, the app also allows customers to create an account to get rewards and vouchers. I had
                    previously created an account and had a few vouchers saved up, so I decided to use them to get a
                    discount on my order.
                </p>

                <p>
                    After eating my succulent chicken and chips, I decided to check my account to see how the website
                    determines the vouchers that are available to me. I opened the developer tools in my browser and
                    looked at the network requests that the website was sending. I discovered that the website was
                    sending a request to an API endpoint to get the vouchers that were available to me. I thought about
                    ways to spoof the response from the API to get more vouchers, but the only software that I knew does
                    this is unavailable on macOS.
                </p>

                <p>
                    So instead of spoofing the vouchers available to me, I continued looking through the network
                    requests to find a url containing a JSON list of every voucher available to every user. I wrote a
                    code to fetch the JSON list of vouchers and ask the user what voucher they would like to use. The
                    program would then make a QR code using the DCODE found in the JSON list and save it to a file for
                    the user to scan in store.

                    For those interested, the URL of the JSON list of vouchers is:
                    <br>
                    <code>https://content-acl.redrooster.com.au/all_loyalty_voucher_info.json</code>
                    <br>
                    I later realised that the DCODE is not used to identify the voucher for the user,
                    rendering the program useless.
                </p>

                <p>
                    After some more time tinkering with the website dev tools, I discovered
                    that if you apply a $5 discount voucher to your order, the server will remove the value of the
                    voucher
                    from the total cost of the order, but there is an issue, in order to get the discount you need to
                    have
                    spent at least $15 on your order. But I found a way to bypass this by messing with the
                    <code>cart</code>
                    variable in the session storage in the browser.
                </p>

                <p>
                    The <code>cart</code> variable is a JSON object that contains the items in your cart, the total cost
                    of
                    the items in your cart, and a list of all the vouchers you applied to your cart which contains all
                    the
                    conditions of the voucher. I found that if I changed the <code>minimumSpend</code> variable to
                    <code>0</code>
                    and set the sessions storage variable to the modified JSON object, the website would think that the
                    voucher
                    was to get a $5 discount on any order, regardless of the total cost.
                </p>

                <img src="assets/5dollardiscount.jpg" />
                <img src="assets/5dollardiscountcode.jpg" />

                <p>
                    Perfect, I had figured out a way to get a $5 discount on any order, regardless of the total price.
                    But if I
                    wanted to get a burger or anything else that cost more than $5, I would need to find a way to figure
                    out how to
                    set the <code>total</code> variable in the <code>cart</code> object to $0. So I tried just that, I
                    set the <code>total</code>
                    variable to $0 and the website accepted the total price of the order as $0. I had successfully found
                    a way to get
                    unlimited free food from Red Rooster.
                </p>

                <p>
                    The code below shows an example of the <code>cart</code> variable in the session storage
                </p>

                <embed src="assets/cartbefore.json" type="application/json" />
                <embed src="assets/cartafter.json" type="application/json" />

                <p>
                    This is very cool but has a downside, the main one being it only works with pickup in store orders,
                    no delivery, this is because the delivery is controlled by doordash. Other than that, it is a very
                    easy way to get free food from Red Rooster.
                </p>

                <p>
                    So yeah that is how I hacked Red Rooster to get unlimited free food. If you have any questions or
                    work at Red Rooster and want to contact me, feel free to <a
                        href="mailto:redroosterexploit@jackweller.me">email me</a>. If you enjoyed reading this article,
                    please consider sending <a href="bitcoin:bc1pz33pxxuxz4jcapkulr5k0haf2kednfwev7xkvcvhdh2rp2qy0rds4nmdrl"
                    target="_blank">me some bitcoin</a> so I can buy more Red Rooster, <i>legally...</i>
                </p>

                <hr>

                <h2>Timeline of Events</h2>
                <ul>
                    <li><time datetime="2024-12-10">December 10, 2024</time>: I discovered the exploit on Red Rooster's
                        website, which allows manipulated orders to be placed without payment.
                    <li><time datetime="2024-12-11">December 11, 2024</time>: I sent an email to Craveable Brands asking
                        if they had a bug bounty policy, inquiring about how I could report security vulnerabilities.
                    <li><time datetime="2024-12-12">December 12, 2024</time>: I called Craveable Brands' customer
                        support and left a voicemail with my details, explaining the security vulnerability I had found.
                    <li><time datetime="2024-12-14">December 14, 2024</time>: I sent Craveable Brands an email stating
                        that I had found a security vulnerability and requesting the appropriate contact to report it.
                    <li><time datetime="2024-12-14">December 14, 2024</time>: I documented all the details about the
                        exploit, including its impact and potential fixes, to ensure clear and accurate communication of
                        the issue.
                    <li><time datetime="2024-12-14">December 14, 2024</time>: I sent Red Rooster an Instagram DM stating
                        that I had found a security vulnerability and requesting the appropriate contact to report it.
                    <li><time datetime="2024-12-16">December 16, 2024</time>: I left a comment on their latest post
                        informing them to check their direct messages since I have found a security vulnerability.
                    <li><time datetime="2024-12-18">December 18, 2024</time>: I sent Craveable Brands an Instagram DM
                        following up on the last message, asking for who I should contact.
                    <li><time datetime="2024-12-23">December 23, 2024</time>: I sent a bug report in the Red Rooster
                        app, asking them to send me an email.
                </ul>

                <hr>

                <p>
                    <b>
                        I have not yet received a response from Craveable Brands or Red Rooster, but I will continue to
                        update this article as the situation progresses.
                    </b>
                </p>
            </div>
        </main>
        <footer>
            <p>&copy; 2023 Jack Weller</p>
            <nav>
                <a href="https://github.com/jackwellerreal" target="_blank">Github</a>
                <a href="bitcoin:bc1pz33pxxuxz4jcapkulr5k0haf2kednfwev7xkvcvhdh2rp2qy0rds4nmdrl"
                    target="_blank">Bitcoin</a>
            </nav>
        </footer>
    </div>
</body>

</html>